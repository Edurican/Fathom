name: Create Weekly Folder

on:
  schedule:
    - cron: '0 0 * * SUN'  # ë§¤ì£¼ ì¼ìš”ì¼ 09:00 KST (ë‹¤ìŒ ì£¼ ì¤€ë¹„)
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰

jobs:
  create-folder:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Create weekly folder
        run: |
          # ë‹¤ìŒ í™”ìš”ì¼ ë‚ ì§œ ê³„ì‚°
          NEXT_TUESDAY=$(date -d "next tuesday" +%Y-%m-%d)
          YEAR=$(date -d "next tuesday" +%Y)
          WEEK=$(date -d "next tuesday" +%V)
          DATE_SHORT=$(date -d "next tuesday" +%m-%d)
          
          FOLDER_PATH="${YEAR}/week${WEEK}-${DATE_SHORT}"
          
          mkdir -p "$FOLDER_PATH"
          
          cat > "$FOLDER_PATH/README.md" << EOF
          # ðŸŒŠ Week ${WEEK} - ${NEXT_TUESDAY}

          ## ì´ë²ˆ ì£¼ ë‹¤ì´ë¸Œ

          | Diver | Topic | Depth | Status |
          |-------|-------|-------|--------|
          | | | | â³ ì¤€ë¹„ì¤‘ |
          | | | | â³ ì¤€ë¹„ì¤‘ |

          ## ì£¼ìš” ë…¼ì˜ ì‚¬í•­

          - 

          ## ë‹¤ìŒ ì£¼ ì˜ˆì •

          | Diver | Topic |
          |-------|-------|
          | | |
          EOF
          
          echo "ðŸ“ Created: $FOLDER_PATH"

      - name: Commit and Push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add .
          git diff --staged --quiet || git commit -m "ðŸŒŠ Week $(date -d 'next tuesday' +%V) í´ë” ìƒì„±"
          git push